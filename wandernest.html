<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accommodation Finder</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      padding: 20px;
      background-color: #f5f7fa;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .panel {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
      flex: 1;
      min-width: 300px;
    }
    #map {
      height: 600px;
      flex: 2;
      min-width: 300px;
      border-radius: 8px;
    }
    h1 {
      color: #2c3e50;
      margin-bottom: 20px;
    }
    h2 {
      color: #34495e;
      margin: 15px 0 10px;
      font-size: 1.2em;
    }
    .filter-group {
      margin-bottom: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }
    .checkbox-item {
      margin: 8px 0;
      display: flex;
      align-items: center;
    }
    input[type="checkbox"] {
      margin-right: 8px;
    }
    label {
      cursor: pointer;
    }
    input[type="text"], 
    input[type="number"],
    select {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
      margin-top: 10px;
      transition: background 0.3s;
    }
    button:hover {
      background: #2980b9;
    }
    button.secondary {
      background: #95a5a6;
    }
    button.secondary:hover {
      background: #7f8c8d;
    }
    .booking-form {
      display: none;
      margin-top: 20px;
    }
    .property-card {
      border: 1px solid #eee;
      padding: 15px;
      margin: 10px 0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .property-card:hover {
      border-color: #3498db;
      box-shadow: 0 2px 8px rgba(52,152,219,0.2);
    }
    .property-card.selected {
      border-color: #2ecc71;
      background: #f0fff4;
    }
    .property-name {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 5px;
    }
    .property-address {
      color: #7f8c8d;
      font-size: 0.9em;
      margin-bottom: 5px;
    }
    .property-price {
      color: #27ae60;
      font-weight: bold;
    }
    .amenity-tag {
      display: inline-block;
      background: #e0f7fa;
      color: #00838f;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.8em;
      margin-right: 5px;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <h1>Find Student Accommodation</h1>
      
      <div class="filter-group">
        <h2>Location</h2>
        <input type="text" id="location" placeholder="Enter city or area">
        
        <h2>Budget (per month)</h2>
        <input type="number" id="budget" placeholder="Enter your budget">
        
        <h2>University (optional)</h2>
        <input type="text" id="university" placeholder="Near which university?">
        <input type="number" id="distance" placeholder="Max distance in km">
      </div>
      
      <div class="filter-group">
        <h2>Amenities</h2>
        
        <div class="checkbox-item">
          <input type="checkbox" id="wifi">
          <label for="wifi">Wi-Fi</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="laundry">
          <label for="laundry">Laundry</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="gym">
          <label for="gym">Gym</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="security">
          <label for="security">24/7 Security</label>
        </div>
        <div class="checkbox-item">
          <input type="checkbox" id="parking">
          <label for="parking">Parking</label>
        </div>
      </div>
      
      <button id="searchBtn">Search Accommodations</button>
      
      <div id="resultsContainer" style="display: none;">
        <h2>Available Properties</h2>
        <div id="propertyList"></div>
      </div>
      
      <div id="bookingForm" class="booking-form">
        <h2>Book This Property</h2>
        <div id="selectedPropertyInfo"></div>
        
        <label for="checkin">Check-in Date</label>
        <input type="date" id="checkin">
        
        <label for="checkout">Check-out Date</label>
        <input type="date" id="checkout">
        
        <label for="guests">Number of Guests</label>
        <select id="guests">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        
        <label for="name">Full Name</label>
        <input type="text" id="name" placeholder="Your full name">
        
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Your email">
        
        <label for="phone">Phone</label>
        <input type="tel" id="phone" placeholder="Your phone number">
        
        <button id="confirmBookingBtn">Confirm Booking</button>
        <button class="secondary" id="backToResultsBtn">Back to Results</button>
      </div>
    </div>
    
    <div id="map" class="panel"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    // Initialize the map
    const map = L.map('map').setView([28.4744, 77.5030], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Sample property data (in a real app, this would come from an API)
    const sampleProperties = [
      {
        id: 1,
        name: "Green Valley Hostel",
        lat: 28.4744,
        lng: 77.5030,
        price: 8000,
        amenities: ["Wi-Fi", "Laundry", "24/7 Security"],
        address: "123 University Road, Greater Noida",
        distanceToUni: "1.2 km"
      },
      {
        id: 2,
        name: "Sunshine Apartments",
        lat: 28.4844,
        lng: 77.5130,
        price: 10000,
        amenities: ["Wi-Fi", "Gym", "Parking", "24/7 Security"],
        address: "456 College Street, Greater Noida",
        distanceToUni: "0.8 km"
      },
      {
        id: 3,
        name: "Cosy Nest PG",
        lat: 28.4644,
        lng: 77.4930,
        price: 7000,
        amenities: ["Wi-Fi", "Laundry"],
        address: "789 Student Lane, Greater Noida",
        distanceToUni: "2.1 km"
      },
      {
        id: 4,
        name: "Elite Residences",
        lat: 28.4944,
        lng: 77.5230,
        price: 12000,
        amenities: ["Wi-Fi", "Gym", "Laundry", "Parking", "24/7 Security"],
        address: "101 Campus Avenue, Greater Noida",
        distanceToUni: "1.5 km"
      }
    ];

    // Global variables
    let markers = [];
    let selectedProperty = null;

    // Search function
    function searchAccommodations() {
      const location = document.getElementById('location').value;
      const budget = document.getElementById('budget').value;
      const university = document.getElementById('university').value;
      const distance = document.getElementById('distance').value;
      
      const amenities = [];
      if (document.getElementById('wifi').checked) amenities.push('Wi-Fi');
      if (document.getElementById('laundry').checked) amenities.push('Laundry');
      if (document.getElementById('gym').checked) amenities.push('Gym');
      if (document.getElementById('security').checked) amenities.push('24/7 Security');
      if (document.getElementById('parking').checked) amenities.push('Parking');
      
      if (!location || !budget) {
        alert('Please enter location and budget');
        return;
      }
      
      // In a real app, we would call an API here
      // For demo, we'll filter our sample properties
      let filteredProperties = sampleProperties.filter(property => {
        // Filter by budget
        if (property.price > budget) return false;
        
        // Filter by amenities
        if (amenities.length > 0) {
          const hasAllAmenities = amenities.every(amenity => 
            property.amenities.includes(amenity)
          );
          if (!hasAllAmenities) return false;
        }
        
        return true;
      });
      
      if (filteredProperties.length === 0) {
        alert('No properties found matching your criteria');
        return;
      }
      
      displayProperties(filteredProperties);
      showOnMap(filteredProperties);
      
      // Show results container
      document.getElementById('resultsContainer').style.display = 'block';
    }
    
    // Display properties in the list
    function displayProperties(properties) {
      const propertyList = document.getElementById('propertyList');
      propertyList.innerHTML = '';
      
      properties.forEach(property => {
        const propertyCard = document.createElement('div');
        propertyCard.className = 'property-card';
        propertyCard.dataset.id = property.id;
        
        propertyCard.innerHTML = `
          <div class="property-name">${property.name}</div>
          <div class="property-address">${property.address}</div>
          <div class="property-price">₹${property.price}/month</div>
          <div>
            ${property.amenities.map(a => `<span class="amenity-tag">${a}</span>`).join('')}
          </div>
          ${property.distanceToUni ? `<div>Distance to uni: ${property.distanceToUni}</div>` : ''}
        `;
        
        propertyCard.addEventListener('click', () => selectProperty(property));
        propertyList.appendChild(propertyCard);
      });
    }
    
    // Show properties on map
    function showOnMap(properties) {
      // Clear previous markers
      markers.forEach(marker => map.removeLayer(marker));
      markers = [];
      
      // Add new markers
      properties.forEach(property => {
        const marker = L.marker([property.lat, property.lng])
          .addTo(map)
          .bindPopup(`<b>${property.name}</b><br>₹${property.price}/month`);
        
        marker.on('click', () => {
          // Highlight the corresponding card
          document.querySelectorAll('.property-card').forEach(card => {
            card.classList.remove('selected');
            if (parseInt(card.dataset.id) === property.id) {
              card.classList.add('selected');
              card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
          });
        });
        
        markers.push(marker);
      });
      
      // Fit map to show all markers
      if (properties.length > 0) {
        const group = new L.featureGroup(markers);
        map.fitBounds(group.getBounds().pad(0.2));
      }
    }
    
    // Select a property for booking
    function selectProperty(property) {
      selectedProperty = property;
      
      // Highlight selected card
      document.querySelectorAll('.property-card').forEach(card => {
        card.classList.remove('selected');
        if (parseInt(card.dataset.id) === property.id) {
          card.classList.add('selected');
        }
      });
      
      // Show booking form
      document.getElementById('resultsContainer').style.display = 'none';
      document.getElementById('bookingForm').style.display = 'block';
      
      // Set property info
      document.getElementById('selectedPropertyInfo').innerHTML = `
        <div class="property-name">${property.name}</div>
        <div class="property-address">${property.address}</div>
        <div class="property-price">₹${property.price}/month</div>
      `;
      
      // Set today's date as min for checkin
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('checkin').min = today;
    }
    
    // Confirm booking
    function confirmBooking() {
      const checkin = document.getElementById('checkin').value;
      const checkout = document.getElementById('checkout').value;
      const guests = document.getElementById('guests').value;
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const phone = document.getElementById('phone').value;
      
      if (!checkin || !checkout || !name || !email || !phone) {
        alert('Please fill all required fields');
        return;
      }
      
      if (new Date(checkout) <= new Date(checkin)) {
        alert('Check-out date must be after check-in date');
        return;
      }
      
      // In a real app, we would send this to a server
      const bookingDetails = {
        property: selectedProperty,
        checkin,
        checkout,
        guests,
        customer: { name, email, phone }
      };
      
      console.log('Booking confirmed:', bookingDetails);
      
      alert(`Booking confirmed for ${selectedProperty.name}!\nWe've sent details to ${email}`);
      
      // Reset the form
      resetForm();
    }
    
    // Back to results from booking form
    function backToResults() {
      document.getElementById('bookingForm').style.display = 'none';
      document.getElementById('resultsContainer').style.display = 'block';
    }
    
    // Reset the form
    function resetForm() {
      document.getElementById('bookingForm').style.display = 'none';
      document.getElementById('resultsContainer').style.display = 'none';
      document.getElementById('searchBtn').click();
    }
    
    // Event listeners
    document.getElementById('searchBtn').addEventListener('click', searchAccommodations);
    document.getElementById('confirmBookingBtn').addEventListener('click', confirmBooking);
    document.getElementById('backToResultsBtn').addEventListener('click', backToResults);
    
    // Set today's date as default for checkin
    document.getElementById('checkin').value = new Date().toISOString().split('T')[0];
    
    // Set tomorrow's date as default for checkout
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('checkout').value = tomorrow.toISOString().split('T')[0];
  </script>
</body>
</html>